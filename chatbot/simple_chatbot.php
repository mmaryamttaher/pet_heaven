<?php
// Simple PHP-based chatbot fallback for when Python service is not available
function getSimpleChatbotResponse($question) {
    $question = strtolower(trim($question));
    
    // Define responses for common pet-related questions
    $responses = [
        // Cat care
        'قطط' => 'القطط تحتاج إلى رعاية خاصة تشمل: طعام عالي الجودة، ماء نظيف، صندوق رمل نظيف، زيارات دورية للطبيب البيطري، واللعب اليومي. هل تريد معرفة المزيد عن رعاية القطط؟',
        'قطة' => 'القطط حيوانات رائعة! تحتاج إلى طعام متوازن، مكان آمن للنوم، وحب واهتمام. ما هو سؤالك المحدد عن القطط؟',
        'طعام القطط' => 'القطط تحتاج طعام غني بالبروتين. أفضل الخيارات: طعام جاف عالي الجودة، طعام رطب، وأحياناً لحوم مطبوخة. تجنب الحليب والشوكولاتة والبصل.',
        
        // Dog care
        'كلاب' => 'الكلاب تحتاج إلى تمارين يومية، طعام متوازن، تدريب منتظم، وحب كبير. هي حيوانات اجتماعية تحب التفاعل مع البشر. ما هو سؤالك عن الكلاب؟',
        'كلب' => 'الكلاب أصدقاء رائعون! تحتاج إلى تمارين، تدريب، طعام جيد، ورعاية صحية. هل تريد نصائح محددة عن رعاية الكلاب؟',
        'تدريب الكلاب' => 'تدريب الكلاب يحتاج صبر وثبات. ابدأ بالأوامر الأساسية: اجلس، قف، تعال. استخدم المكافآت الإيجابية وكن متسقاً في التدريب.',
        
        // Birds
        'طيور' => 'الطيور تحتاج قفص واسع، طعام متنوع من البذور والفواكه، ماء نظيف، وتفاعل اجتماعي. بعض الأنواع تحتاج رفقة من نفس النوع.',
        'عصافير' => 'العصافير طيور جميلة تحتاج رعاية خاصة. تحب البذور المتنوعة، الخضار الطازجة، والمساحة للطيران. هل تريد نصائح عن نوع معين؟',
        
        // General pet care
        'رعاية' => 'رعاية الحيوانات الأليفة تشمل: التغذية السليمة، الرعاية الصحية، التمارين، النظافة، والحب. كل نوع له احتياجات خاصة.',
        'طعام' => 'التغذية السليمة أساس صحة الحيوانات. اختر طعام عالي الجودة مناسب لنوع وعمر حيوانك الأليف. تجنب الطعام المضر مثل الشوكولاتة للكلاب والقطط.',
        'صحة' => 'الرعاية الصحية مهمة جداً. زيارات دورية للطبيب البيطري، تطعيمات منتظمة، ومراقبة أي تغييرات في السلوك أو الشهية.',
        
        // Health issues
        'مريض' => 'علامات المرض في الحيوانات: فقدان الشهية، خمول، تغيير في السلوك، إسهال أو قيء، صعوبة في التنفس. راجع الطبيب البيطري فوراً.',
        'طبيب بيطري' => 'الطبيب البيطري ضروري لصحة حيوانك. زيارات دورية للفحص، تطعيمات، وعلاج أي مشاكل صحية. لا تتأخر في زيارة الطبيب عند ملاحظة أي أعراض.',
        
        // Behavior
        'سلوك' => 'سلوك الحيوانات يعكس صحتها النفسية والجسدية. التغييرات المفاجئة قد تدل على مشكلة. اللعب والتفاعل مهمان للصحة النفسية.',
        'عدوانية' => 'العدوانية في الحيوانات قد تكون بسبب الخوف، الألم، أو عدم التدريب. استشر مدرب حيوانات أو طبيب بيطري لحل المشكلة.',
        
        // Default responses
        'مرحبا' => 'مرحباً بك! أنا مساعدك المتخصص في الحيوانات الأليفة. يمكنني مساعدتك في أسئلة حول رعاية القطط، الكلاب، الطيور، وغيرها من الحيوانات الأليفة. ما هو سؤالك؟',
        'شكرا' => 'عفواً! سعيد لمساعدتك. إذا كان لديك أي أسئلة أخرى عن الحيوانات الأليفة، لا تتردد في السؤال!',
        'وداعا' => 'وداعاً! أتمنى أن تكون المعلومات مفيدة. اعتن بحيوانك الأليف واستمتع بوقتكما معاً! 🐾'
    ];
    
    // Check for exact matches first
    foreach ($responses as $keyword => $response) {
        if (strpos($question, $keyword) !== false) {
            return $response;
        }
    }
    
    // If no match found, provide general response
    $general_responses = [
        'أنا متخصص في الحيوانات الأليفة. يمكنني مساعدتك في أسئلة حول رعاية القطط، الكلاب، الطيور، والحيوانات الأليفة الأخرى. هل يمكنك إعادة صياغة سؤالك؟',
        'لم أفهم سؤالك تماماً. يمكنني مساعدتك في موضوعات مثل: رعاية الحيوانات، التغذية، الصحة، السلوك، والتدريب. ما هو سؤالك المحدد؟',
        'أنا هنا لمساعدتك في كل ما يتعلق بالحيوانات الأليفة. جرب أن تسأل عن: "كيف أرعى قطتي؟" أو "ما هو أفضل طعام للكلاب؟"'
    ];
    
    return $general_responses[array_rand($general_responses)];
}

// Enhanced chatbot with more intelligent matching
function getEnhancedChatbotResponse($question) {
    $question = strtolower(trim($question));
    
    // Remove common words
    $common_words = ['كيف', 'ما', 'هو', 'هي', 'في', 'من', 'إلى', 'على', 'عن', 'مع', 'أن', 'أو', 'لا', 'نعم'];
    $words = explode(' ', $question);
    $keywords = array_diff($words, $common_words);
    
    // Advanced pattern matching
    $patterns = [
        // Feeding patterns
        '/طعام|أكل|تغذية|يأكل|تأكل/' => 'التغذية السليمة أساس صحة الحيوان. اختر طعام عالي الجودة مناسب لنوع وعمر حيوانك. تجنب الأطعمة المضرة وقدم وجبات منتظمة.',
        
        // Health patterns
        '/مريض|صحة|علاج|دواء|طبيب/' => 'الرعاية الصحية مهمة جداً. راقب حيوانك للتأكد من عدم وجود أعراض مرضية، وقم بزيارات دورية للطبيب البيطري للفحص والتطعيمات.',
        
        // Training patterns
        '/تدريب|تعليم|سلوك|عدوانية|مشاكل/' => 'التدريب يحتاج صبر وثبات. استخدم التعزيز الإيجابي، كن متسقاً في الأوامر، وابدأ بالأساسيات. إذا كانت هناك مشاكل سلوكية، استشر مختص.',
        
        // Cat specific
        '/قط|قطة|قطط/' => 'القطط حيوانات رائعة تحتاج: طعام عالي البروتين، صندوق رمل نظيف، مكان آمن للنوم، لعب تفاعلي، ورعاية صحية منتظمة.',
        
        // Dog specific
        '/كلب|كلاب/' => 'الكلاب تحتاج تمارين يومية، تدريب منتظم، طعام متوازن، تفاعل اجتماعي، ورعاية صحية. هي حيوانات وفية تحب التفاعل مع أصحابها.',
        
        // Bird specific
        '/طير|طيور|عصفور|عصافير/' => 'الطيور تحتاج قفص واسع، طعام متنوع من البذور والفواكه، ماء نظيف، وتفاعل اجتماعي. بعض الأنواع تحتاج رفقة.',
        
        // General care
        '/رعاية|اهتمام|عناية/' => 'رعاية الحيوانات تشمل: التغذية السليمة، الرعاية الصحية، التمارين المناسبة، النظافة، والحب والاهتمام. كل نوع له احتياجات خاصة.'
    ];
    
    foreach ($patterns as $pattern => $response) {
        if (preg_match($pattern, $question)) {
            return $response;
        }
    }
    
    // If no pattern matches, use simple matching
    return getSimpleChatbotResponse($question);
}
?>
